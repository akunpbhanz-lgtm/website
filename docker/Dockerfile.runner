FROM debian:bookworm-slim
RUN apt-get update && apt-get install -y python3 python3-pip && rm -rf /var/lib/apt/lists/*
RUN useradd -m runner
USER runner
WORKDIR /workspace
COPY --chown=runner:runner . /workspace
RUN pip3 install --user --no-cache-dir -r requirements.txt || true
ENV PATH=/home/runner/.local/bin:$PATH
ENTRYPOINT ["python3", "-m", "agent.main"]
